<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Resume Analyzer | Gen AI Powered</title>
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Chart.js for visualizations -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    
    <!-- Animate.css -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        /* Animated background particles */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            pointer-events: none;
        }

        .particle {
            position: absolute;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            animation: float 6s infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        /* Header/Navbar */
        .navbar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            animation: slideDown 0.8s ease;
        }

        @keyframes slideDown {
            from { transform: translateY(-100px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo i {
            font-size: 32px;
            color: #667eea;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .logo h1 {
            font-size: 24px;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .badge {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 8px 16px;
            border-radius: 30px;
            font-size: 14px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .badge i {
            font-size: 16px;
        }

        /* Main Grid Layout */
        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 25px;
        }

        /* Cards */
        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 24px;
            padding: 25px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
            transition: all 0.3s ease;
            border: 1px solid rgba(255,255,255,0.2);
            animation: fadeInUp 0.8s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 30px 80px rgba(0,0,0,0.2);
        }

        @keyframes fadeInUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .card-header i {
            font-size: 28px;
            color: #667eea;
            background: linear-gradient(135deg, #667eea20, #764ba220);
            padding: 12px;
            border-radius: 16px;
        }

        .card-header h2 {
            font-size: 20px;
            font-weight: 600;
            color: #333;
        }

        .card-header span {
            margin-left: auto;
            background: #f0f0f0;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
            color: #666;
        }

        /* Textareas */
        .textarea-container {
            position: relative;
            margin-bottom: 15px;
        }

        textarea {
            width: 100%;
            height: 200px;
            padding: 20px;
            border: 2px solid #e0e0e0;
            border-radius: 16px;
            font-family: 'Inter', sans-serif;
            font-size: 14px;
            line-height: 1.6;
            resize: none;
            transition: all 0.3s;
            background: #fafafa;
        }

        textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
            background: white;
        }

        .char-count {
            position: absolute;
            bottom: 10px;
            right: 15px;
            font-size: 12px;
            color: #999;
            background: rgba(255,255,255,0.9);
            padding: 4px 8px;
            border-radius: 12px;
        }

        /* Feature Toggles */
        .feature-toggles {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .toggle {
            display: flex;
            align-items: center;
            gap: 8px;
            background: #f5f5f5;
            padding: 10px 18px;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .toggle:hover {
            background: #e8e8e8;
        }

        .toggle.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-color: white;
        }

        .toggle i {
            font-size: 16px;
        }

        /* PDF Upload Status */
        .pdf-status {
            font-size: 12px;
            margin-top: 5px;
            padding: 5px 10px;
            border-radius: 20px;
            background: #f0f0f0;
            display: inline-block;
        }

        .pdf-status.success {
            background: #e3fcef;
            color: #0e6245;
        }

        .pdf-status.error {
            background: #fee9e9;
            color: #b91c1c;
        }

        /* Analyze Button */
        .analyze-btn {
            width: 100%;
            padding: 18px;
            border: none;
            border-radius: 16px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            position: relative;
            overflow: hidden;
        }

        .analyze-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .analyze-btn:hover::before {
            left: 100%;
        }

        .analyze-btn:hover {
            transform: scale(1.02);
            box-shadow: 0 20px 40px rgba(102, 126, 234, 0.4);
        }

        .analyze-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }

        .spinner {
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Results Section */
        .results-section {
            margin-top: 30px;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 25px;
        }

        .stat-card {
            background: white;
            border-radius: 24px;
            padding: 25px 20px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.3);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #4f46e5, #7c3aed);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(79, 70, 229, 0.15);
        }

        .stat-value {
            font-size: 48px !important;
            font-weight: 800 !important;
            margin: 15px 0 5px;
            color: #1e293b !important;
            line-height: 1.2;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.05);
            -webkit-text-fill-color: #1e293b !important;
            background: none !important;
        }

        .stat-label {
            color: #64748b !important;
            font-weight: 600;
            font-size: 16px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-detail {
            margin-top: 10px;
            font-size: 13px;
            font-weight: 500;
        }

        /* Skills Chips */
        .skills-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
        }

        .skill-chip {
            padding: 8px 16px;
            border-radius: 30px;
            font-size: 13px;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            animation: chipPop 0.5s ease;
        }

        @keyframes chipPop {
            from { transform: scale(0); }
            to { transform: scale(1); }
        }

        .skill-chip.matched {
            background: #e3fcef;
            color: #0e6245;
            border: 1px solid #a3e9cd;
        }

        .skill-chip.missing {
            background: #fee9e9;
            color: #b91c1c;
            border: 1px solid #fecaca;
        }

        .skill-chip i {
            font-size: 12px;
        }

        /* Progress Bar */
        .progress-container {
            background: #f0f0f0;
            border-radius: 30px;
            height: 12px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 30px;
            transition: width 1s ease;
            position: relative;
            overflow: hidden;
        }

        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* Chart Container */
        .chart-container {
            height: 300px;
            margin: 20px 0;
            padding: 15px;
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }

        /* AI Insights */
        .insights-card {
            background: linear-gradient(135deg, #f8f9ff, #f0f2ff);
            border-radius: 20px;
            padding: 25px;
            margin: 20px 0;
            border-left: 6px solid #667eea;
        }

        .insights-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .insights-header i {
            font-size: 24px;
            color: #667eea;
        }

        .insights-text {
            font-size: 16px;
            line-height: 1.8;
            color: #333;
        }

        /* Timeline */
        .timeline {
            margin: 20px 0;
        }

        .timeline-item {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 12px;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from { transform: translateX(-20px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .timeline-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .results-grid {
                grid-template-columns: 1fr;
            }
            
            .navbar {
                flex-direction: column;
                gap: 15px;
            }
        }

        /* Loading Skeleton */
        .skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* Tooltips */
        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background: #333;
            color: white;
            text-align: center;
            padding: 8px;
            border-radius: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 12px;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
    </style>
</head>
<body>
    <!-- Animated Background Particles -->
    <div class="particles" id="particles"></div>

    <div class="container">
        <!-- Navbar -->
        <nav class="navbar animate__animated animate__fadeInDown">
            <div class="logo">
                <i class="fas fa-robot"></i>
                <h1>AI Resume Analyzer</h1>
            </div>
            <div class="badge">
                <i class="fas fa-microchip"></i>
                <span>Powered by Azure AI & Gen AI</span>
            </div>
        </nav>

        <!-- Main Dashboard Grid -->
        <div class="dashboard-grid">
            <!-- Resume Card -->
            <div class="card">
                <div class="card-header">
                    <i class="fas fa-file-alt"></i>
                    <h2>Resume / CV</h2>
                    <span class="tooltip">
                        <i class="fas fa-info-circle"></i>
                        <span class="tooltiptext">Paste your resume text or upload PDF</span>
                    </span>
                </div>
                <div class="textarea-container">
                    <textarea id="resume" placeholder="Paste your resume content here..."></textarea>
                    <div class="char-count" id="resumeCount">0 characters</div>
                </div>
                
                <!-- PDF Upload Status -->
                <div id="pdfStatus" class="pdf-status"></div>
                
                <div class="feature-toggles">
                    <div class="toggle" onclick="document.getElementById('pdfUpload').click();" id="pdfToggle">
                        <i class="fas fa-file-pdf"></i>
                        <span>Upload PDF</span>
                    </div>
                    <div class="toggle" onclick="toggleFeature('parse')" id="parseToggle">
                        <i class="fas fa-magic"></i>
                        <span>Auto-parse</span>
                    </div>
                </div>
                
                <!-- Hidden PDF Upload with improved handling -->
                <input type="file" id="pdfUpload" accept=".pdf" style="display: none;" onchange="uploadPDF(this)">
            </div>

            <!-- Job Description Card -->
            <div class="card">
                <div class="card-header">
                    <i class="fas fa-briefcase"></i>
                    <h2>Job Description</h2>
                    <span class="tooltip">
                        <i class="fas fa-info-circle"></i>
                        <span class="tooltiptext">Paste the job requirements here</span>
                    </span>
                </div>
                <div class="textarea-container">
                    <textarea id="job" placeholder="Paste job description here..."></textarea>
                    <div class="char-count" id="jobCount">0 characters</div>
                </div>
                <div class="feature-toggles">
                    <div class="toggle active" onclick="toggleFeature('genai')" id="genaiToggle">
                        <i class="fas fa-brain"></i>
                        <span>Gen AI</span>
                    </div>
                    <div class="toggle active" onclick="toggleFeature('azure')" id="azureToggle">
                        <i class="fas fa-cloud"></i>
                        <span>Azure AI</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Analyze Button -->
        <button class="analyze-btn" onclick="analyze()" id="analyzeBtn">
            <i class="fas fa-search"></i>
            <span>Analyze with AI</span>
            <i class="fas fa-arrow-right"></i>
        </button>

        <!-- Results Section -->
        <div class="results-section" id="resultsSection" style="display: none;">
            <!-- Stats Cards -->
            <div class="results-grid">
                <div class="stat-card animate__animated animate__fadeInUp">
                    <i class="fas fa-chart-line" style="font-size: 28px; color: #4f46e5; background: rgba(79, 70, 229, 0.1); padding: 15px; border-radius: 50%;"></i>
                    <div class="stat-value" id="matchPercentage">0%</div>
                    <div class="stat-label">Match Score</div>
                    <div class="stat-detail" id="matchDetail" style="color: #4f46e5;">Ready to analyze</div>
                </div>
                
                <div class="stat-card animate__animated animate__fadeInUp" style="animation-delay: 0.1s">
                    <i class="fas fa-check-circle" style="font-size: 28px; color: #059669; background: rgba(5, 150, 105, 0.1); padding: 15px; border-radius: 50%;"></i>
                    <div class="stat-value" id="matchedCount">0</div>
                    <div class="stat-label">Matched Skills</div>
                    <div class="stat-detail" id="matchedDetail" style="color: #059669;">Skills found</div>
                </div>
                
                <div class="stat-card animate__animated animate__fadeInUp" style="animation-delay: 0.2s">
                    <i class="fas fa-exclamation-triangle" style="font-size: 28px; color: #dc2626; background: rgba(220, 38, 38, 0.1); padding: 15px; border-radius: 50%;"></i>
                    <div class="stat-value" id="missingCount">0</div>
                    <div class="stat-label">Skill Gaps</div>
                    <div class="stat-detail" id="missingDetail" style="color: #dc2626;">To improve</div>
                </div>
            </div>

            <!-- Progress Bar -->
            <div class="card" style="animation-delay: 0.3s">
                <div class="card-header">
                    <i class="fas fa-tachometer-alt"></i>
                    <h2>Match Analysis</h2>
                    <span>Confidence: <span id="confidenceScore">0%</span></span>
                </div>
                <div class="progress-container">
                    <div class="progress-bar" id="progressBar" style="width: 0%"></div>
                </div>
            </div>

            <!-- Skills & Insights Grid -->
            <div class="dashboard-grid" style="animation-delay: 0.4s">
                <!-- Matched Skills -->
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-check-circle" style="color: #0e6245;"></i>
                        <h2>Matched Skills</h2>
                    </div>
                    <div class="skills-container" id="matchedSkills"></div>
                </div>

                <!-- Missing Skills -->
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-exclamation-circle" style="color: #b91c1c;"></i>
                        <h2>Skill Gaps</h2>
                    </div>
                    <div class="skills-container" id="missingSkills"></div>
                </div>
            </div>

            <!-- Chart Visualization -->
            <div class="card" style="animation-delay: 0.5s">
                <div class="card-header">
                    <i class="fas fa-chart-pie"></i>
                    <h2>Skill Distribution</h2>
                </div>
                <div class="chart-container">
                    <canvas id="skillsChart"></canvas>
                </div>
            </div>

            <!-- AI Insights Card -->
            <div class="insights-card animate__animated animate__fadeInUp" style="animation-delay: 0.6s" id="insightsCard">
                <div class="insights-header">
                    <i class="fas fa-robot"></i>
                    <h3>ü§ñ Gen AI Insights</h3>
                </div>
                <div class="insights-text" id="aiSuggestions">
                    Analyzing your profile...
                </div>
            </div>

            <!-- Learning Timeline -->
            <div class="card" style="animation-delay: 0.7s" id="timelineCard">
                <div class="card-header">
                    <i class="fas fa-road"></i>
                    <h2>Personalized Learning Path</h2>
                </div>
                <div class="timeline" id="learningTimeline">
                    <!-- Dynamically populated -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // State management
        let features = {
            genai: true,
            azure: true,
            pdf: false,
            parse: false
        };

        let chart = null;

        // Toggle features
        function toggleFeature(feature) {
            features[feature] = !features[feature];
            const element = document.getElementById(feature + 'Toggle');
            if (features[feature]) {
                element.classList.add('active');
            } else {
                element.classList.remove('active');
            }
        }

        // Character counters
        document.getElementById('resume').addEventListener('input', function() {
            document.getElementById('resumeCount').textContent = this.value.length + ' characters';
        });

        document.getElementById('job').addEventListener('input', function() {
            document.getElementById('jobCount').textContent = this.value.length + ' characters';
        });

        // FIXED: PDF Upload function with actual backend call
        async function uploadPDF(input) {
            const statusDiv = document.getElementById('pdfStatus');
            
            if (!input.files || !input.files[0]) {
                statusDiv.textContent = '‚ùå No file selected';
                statusDiv.className = 'pdf-status error';
                return;
            }

            const file = input.files[0];
            
            // Validate file type
            if (file.type !== 'application/pdf') {
                statusDiv.textContent = '‚ùå Please select a PDF file';
                statusDiv.className = 'pdf-status error';
                return;
            }

            // Validate file size (max 5MB)
            if (file.size > 5 * 1024 * 1024) {
                statusDiv.textContent = '‚ùå File too large (max 5MB)';
                statusDiv.className = 'pdf-status error';
                return;
            }

            // Show uploading status
            statusDiv.textContent = `üì§ Uploading ${file.name}...`;
            statusDiv.className = 'pdf-status';

            // Create form data
            const formData = new FormData();
            formData.append('file', file);

            try {
                // Try to upload to backend
                const response = await fetch('http://127.0.0.1:8000/upload-pdf', {
                    method: 'POST',
                    body: formData
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                
                // Success! Update textarea with extracted text
                document.getElementById('resume').value = data.extracted_text;
                document.getElementById('resumeCount').textContent = data.extracted_text.length + ' characters';
                
                statusDiv.textContent = `‚úÖ PDF uploaded: ${data.pages} pages extracted`;
                statusDiv.className = 'pdf-status success';
                
                // Auto-enable parse feature
                features.parse = true;
                document.getElementById('parseToggle').classList.add('active');

            } catch (error) {
                console.error('Upload error:', error);
                
                // FALLBACK: If backend not available, use mock PDF extraction
                statusDiv.textContent = '‚ö†Ô∏è Using demo PDF extraction...';
                
                // Mock PDF text extraction for demo
                setTimeout(() => {
                    const mockExtractedText = 
                        "Experienced Python Developer with 5 years in FastAPI, Azure Cloud, and Docker. " +
                        "Skilled in machine learning, TensorFlow, and AI implementations. " +
                        "Led 3 major cloud migration projects to Azure. " +
                        "Certified Azure Developer Associate.";
                    
                    document.getElementById('resume').value = mockExtractedText;
                    document.getElementById('resumeCount').textContent = mockExtractedText.length + ' characters';
                    
                    statusDiv.textContent = '‚úÖ PDF processed (Demo Mode)';
                    statusDiv.className = 'pdf-status success';
                }, 2000);
            }
        }

        // PDF toggle click - FIXED: Now properly triggers file upload
        document.getElementById('pdfToggle').addEventListener('click', function() {
            document.getElementById('pdfUpload').click();
        });

        // Main analyze function
        async function analyze() {
            const resume = document.getElementById("resume").value;
            const job = document.getElementById("job").value;
            const analyzeBtn = document.getElementById("analyzeBtn");

            if (!resume || !job) {
                alert("Please fill in both resume and job description!");
                return;
            }

            // Show loading state
            analyzeBtn.disabled = true;
            analyzeBtn.innerHTML = '<div class="spinner"></div><span>Analyzing with AI...</span>';

            try {
                const response = await fetch("http://127.0.0.1:8000/analyze", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({
                        resume: resume,
                        job_description: job,
                        include_gen_ai: features.genai,
                        analyze_entities: features.azure
                    })
                });

                const data = await response.json();
                displayResults(data);

            } catch (error) {
                console.error("Error:", error);
                alert("‚ö†Ô∏è Backend not running. Using demo data...");
                
                // Demo data for presentation
                displayResults({
                    match_percentage: 78,
                    matched_skills: ["Python", "FastAPI", "Azure", "Docker"],
                    missing_skills: ["Kubernetes", "Terraform", "Jenkins"],
                    suggestions: "Consider learning Kubernetes and infrastructure as code tools.",
                    confidence_score: 0.85,
                    extracted_entities: [
                        {"text": "Python", "category": "Skill"},
                        {"text": "Azure", "category": "Technology"}
                    ],
                    skill_gaps_analysis: {
                        suggestions: [
                            "Complete Azure Kubernetes Service certification",
                            "Build a CI/CD pipeline with Jenkins",
                            "Learn Terraform for infrastructure automation"
                        ],
                        resources: [
                            "https://learn.microsoft.com/azure/aks",
                            "https://www.terraform.io/learn"
                        ],
                        estimated_time: "6 weeks"
                    }
                });
            } finally {
                analyzeBtn.disabled = false;
                analyzeBtn.innerHTML = '<i class="fas fa-search"></i><span>Analyze with AI</span><i class="fas fa-arrow-right"></i>';
            }
        }

        // Display results with animations
        function displayResults(data) {
            // Show results section
            const resultsSection = document.getElementById("resultsSection");
            resultsSection.style.display = "block";
            resultsSection.scrollIntoView({ behavior: "smooth" });

            // Update stats with enhanced details
            document.getElementById("matchPercentage").textContent = data.match_percentage + "%";
            document.getElementById("matchedCount").textContent = data.matched_skills.length;
            document.getElementById("missingCount").textContent = data.missing_skills.length;
            document.getElementById("progressBar").style.width = data.match_percentage + "%";
            document.getElementById("confidenceScore").textContent = 
                Math.round((data.confidence_score || 0.85) * 100) + "%";

            // Add descriptive text based on match percentage
            const matchDetail = document.getElementById("matchDetail");
            if (data.match_percentage >= 80) {
                matchDetail.textContent = "üèÜ Excellent match!";
                matchDetail.style.color = "#059669";
            } else if (data.match_percentage >= 60) {
                matchDetail.textContent = "üëç Good match";
                matchDetail.style.color = "#4f46e5";
            } else if (data.match_percentage >= 40) {
                matchDetail.textContent = "‚ö†Ô∏è Average match";
                matchDetail.style.color = "#d97706";
            } else {
                matchDetail.textContent = "‚ùå Needs improvement";
                matchDetail.style.color = "#dc2626";
            }

            // Update matched skills detail
            document.getElementById("matchedDetail").innerHTML = 
                `<i class="fas fa-arrow-up" style="font-size: 12px;"></i> ${data.matched_skills.length} of ${data.matched_skills.length + data.missing_skills.length} required skills`;

            // Update missing skills detail
            if (data.missing_skills.length > 0) {
                document.getElementById("missingDetail").innerHTML = 
                    `<i class="fas fa-arrow-down" style="font-size: 12px;"></i> Focus on: ${data.missing_skills.slice(0, 2).join(', ')}${data.missing_skills.length > 2 ? '...' : ''}`;
            } else {
                document.getElementById("missingDetail").innerHTML = "No gaps found! üéâ";
            }

            // Update skills
            const matchedContainer = document.getElementById("matchedSkills");
            matchedContainer.innerHTML = '';
            data.matched_skills.forEach(skill => {
                matchedContainer.innerHTML += `
                    <span class="skill-chip matched animate__animated animate__zoomIn">
                        <i class="fas fa-check-circle"></i>
                        ${skill}
                    </span>
                `;
            });

            const missingContainer = document.getElementById("missingSkills");
            missingContainer.innerHTML = '';
            data.missing_skills.forEach(skill => {
                missingContainer.innerHTML += `
                    <span class="skill-chip missing animate__animated animate__zoomIn">
                        <i class="fas fa-times-circle"></i>
                        ${skill}
                    </span>
                `;
            });

            // Update AI insights
            const aiSuggestions = document.getElementById("aiSuggestions");
            if (data.skill_gaps_analysis) {
                aiSuggestions.innerHTML = `
                    <p>üéØ <strong>Learning Path:</strong> ${data.skill_gaps_analysis.suggestions.join(' ‚Üí ')}</p>
                    <p style="margin-top: 10px">‚è±Ô∏è <strong>Estimated Time:</strong> ${data.skill_gaps_analysis.estimated_time}</p>
                `;

                // Update timeline
                const timeline = document.getElementById("learningTimeline");
                timeline.innerHTML = '';
                data.skill_gaps_analysis.suggestions.forEach((suggestion, index) => {
                    timeline.innerHTML += `
                        <div class="timeline-item animate__animated animate__fadeInLeft" style="animation-delay: ${index * 0.1}s">
                            <div class="timeline-icon">
                                <i class="fas fa-${index + 1}"></i>
                            </div>
                            <div>
                                <h4 style="margin-bottom: 5px">Step ${index + 1}</h4>
                                <p style="color: #666">${suggestion}</p>
                            </div>
                        </div>
                    `;
                });
            } else {
                aiSuggestions.innerHTML = data.suggestions;
            }

            // Update chart
            updateChart(data.matched_skills.length, data.missing_skills.length);
        }

        // Chart update function
        function updateChart(matched, missing) {
            const ctx = document.getElementById('skillsChart').getContext('2d');
            
            if (chart) {
                chart.destroy();
            }

            chart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Matched Skills', 'Skill Gaps'],
                    datasets: [{
                        data: [matched, missing],
                        backgroundColor: [
                            '#059669',
                            '#dc2626'
                        ],
                        borderColor: [
                            '#ffffff',
                            '#ffffff'
                        ],
                        borderWidth: 3,
                        hoverOffset: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '65%',
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                font: {
                                    size: 14,
                                    weight: '600'
                                },
                                padding: 20
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.label}: ${context.raw} skills`;
                                }
                            }
                        }
                    },
                    animation: {
                        animateScale: true,
                        animateRotate: true,
                        duration: 2000,
                        easing: 'easeInOutQuart'
                    }
                }
            });
        }

        // Generate particles for background
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            for (let i = 0; i < 30; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                const size = Math.random() * 10 + 5;
                particle.style.width = size + 'px';
                particle.style.height = size + 'px';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 5 + 's';
                particle.style.animationDuration = (Math.random() * 10 + 10) + 's';
                particlesContainer.appendChild(particle);
            }
        }

        // Initialize particles
        createParticles();

        // Add sample data on load (for demo)
        window.onload = function() {
            document.getElementById("resume").value = 
                "Senior Python Developer with 5 years experience in FastAPI, Azure Cloud Services, " +
                "Docker containers, and SQL databases. Led migration of 10+ microservices to Azure " +
                "Kubernetes Service. Implemented CI/CD pipelines using Jenkins and GitHub Actions.";
            
            document.getElementById("job").value = 
                "Looking for a Senior Python Developer with expertise in FastAPI, Azure, Docker, " +
                "and Kubernetes. Must have experience with cloud-native architectures and microservices. " +
                "Knowledge of Terraform and Jenkins is a plus.";
            
            document.getElementById("resumeCount").textContent = 
                document.getElementById("resume").value.length + ' characters';
            document.getElementById("jobCount").textContent = 
                document.getElementById("job").value.length + ' characters';
        };
    </script>
</body>
</html>